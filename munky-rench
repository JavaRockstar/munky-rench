#!/bin/bash
#
#
#
#
# Munky-rench is the swiss army knife for apk modding in bash
# Licensed under GPL


DESC="Munky Rench is the swiss-army knife of apk modding in Linux"
VERSION="VERSION 1.0 INITIAL RELEASE"



#
echo
echo " ----miketheinkman---miketheinkman---miketheinkman----"
echo
echo "   MM       MM  U      U  N      N   K   K   Y     Y "
echo "   M M     M M  U      U  NN     N   K  K    Y     Y "
echo "   M  M   M  M  U      U  N N    N   KKK      Y   Y  " 
echo "   M   M M   M  U      U  N  N   N   K  K      Y Y   "  
echo "   M    M    M  U      U  N   N  N   K   K      Y    "
echo "   M         M   U    U   N    N N   K    K     Y    "
echo "   M         M    UUUU    N     NN   K     K    Y    "
echo "                                                      "
echo " ----RENCH---RENCH---RENCH---RENCH---RENCH---RENCH----" 
echo                                          
echo $VERSION  
echo
echo $DESC
echo
echo "ENTER to continue"

read

echo
echo
echo "                     APK MUNKY-BUSINESS "
echo "------------------------------------------------------------"
echo "1)unzip apk for theming" # functional


echo "2)zip themed apk" # functional


echo "3)install frameworks - important for recompiling!!!" # test

echo "4)decompile apk for modding" # functional


echo "5)recompile" # functional


echo "6)sign apk" 


echo "7)zipalign"


echo "8)recompile as system app- will not change signature"

                                                                                 
echo "99)exit" 


echo
echo
echo "------------------------------------------------------------"
echo
echo "pick your munky business"


read n

	case $n in

	1) # UNZIP
	
	echo
	echo
	echo
	echo "Unzipping an apk allows for the replacement of images,"
	echo "but does not allow for modification of code."
	echo
	echo "After replacing images, you must re-zip."
	echo
	echo "For more info, select 'help' from 'munky menu'"
	echo
	echo "press ENTER to continue"
	echo
	
	read

             cd ~/android/munky-rench/place-here-for-modding

		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
			
					cd ~/android/munky-rench/place-here-for-modding
	

						OUTPUTS=`ls | sed -n $choice'p' `	



			
			unzip ~/android/munky-rench/place-here-for-modding/$OUTPUTS -d ~/android/munky-rench/theme-projects/$OUTPUTS

											
										


				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "Unzipped files in 'theme' directory. You can now replace images for customization "
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

				
					./munky-rench ;;


	2)  # ZIP APK
	
		echo
		echo
		echo
		echo "Zipping an apk simply repackages the files into"
		echo "a useable form."
		echo
		echo "After zipping, apk is ready to install."
		echo
		echo "For more info, select 'help' from 'munky menu'"
		echo
		echo "press ENTER to continue"
		echo	
		read
	
			 cd ~/android/munky-rench/theme-projects

		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
	

						OUTPUTS=`ls | sed -n $choice'p' `	



				
	
							mv $OUTPUTS temp
	
	
									zip -r -0 temp{.zip,} 
	
										mv temp.zip themed_$OUTPUTS

											
										mv -f themed_$OUTPUTS ~/android/munky-rench/out


				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "themed apk in 'out' directory. You can now replace images for customization "
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

				
					./munky-rench ;;

	3) # INSTALL FRAMEWORK
	
	
		echo
		echo
		echo
		echo "Apks are designed to run within the existing"
		echo "framework of Android.  You must install the framework-res.apk"
		echo "from the /system/framework folder of your device."
		echo
		echo "Non AOSP roms usually have a proprietary framework also."
		echo "The location of these second frameworks will vary."
		echo
		echo "For more info, select 'help' from 'munky menu'"
		echo
		echo "press ENTER to continue"
		echo
		read
	
		cd ~/android/munky-rench/frameworks	
			
		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
	

						OUTPUTS=`ls | sed -n $choice'p' `	



				
	
						apktool if $OUTPUTS

				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "Repeat process to add other frameworks "
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

				
					./munky-rench ;;


	4) # DECOMPILE
	
		echo
		echo
		echo
		echo "Decompiling an apk reduces it to its editable source."
		echo "You can change the behavior and features of the app,"
		echo "IF you know what you are doing."
		echo
		echo "Java and Xml are the languages you will need to edit source."
		echo
		echo "For more info, select 'help' from 'munky menu'"
		echo
		echo "press ENTER to continue"
		echo	
		read
	
		cd ~/android/munky-rench/place-here-for-modding

		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
			
					cd ~/android/munky-rench/place-here-for-modding
	

						OUTPUTS=`ls | sed -n $choice'p' `	



							apktool d $OUTPUTS  ~/android/munky-rench/mod-projects/$OUTPUTS

											
								


				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "Decompiled files in 'mod' directory. You can now replace images and edit or add code "
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

				
					./munky-rench ;;

	5) # RECOMPILE
	
	
		echo
		echo
		echo
		echo "This will compile the source into byte code."
		echo "The app will not be ready to install until you sign it."
		echo
		echo "For more info, select 'help' from 'munky menu'"
		echo
		echo "press ENTER to continue"
		echo	
		read
	
		cd ~/android/munky-rench/mod-projects

		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
	

						OUTPUTS=`ls | sed -n $choice'p' `	



							apktool b $OUTPUTS  ~/android/munky-rench/out/$OUTPUTS


						mv ~/android/munky-rench/out/$OUTPUTS  ~/android/munky-rench/out/unsigned_$OUTPUTS



											
								


				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "unsigned apk in 'out' directory. Sign and zipalign apk before install "
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

			
					./munky-rench ;;
	
		
	7) # ZIPALIGN
	
	
	
		echo "place apk to be zipaligned in 'zipalign' directory"
		
		echo "press ENTER when ready"	

			read	
		

		cd ~/android/munky-rench/zipalign

		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
	

						OUTPUTS=`ls | sed -n $choice'p' `

							



							


						



											
								


				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "zipaligned apk in 'out' directory. "
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

			
					./munky-rench ;;
	


        8) # COMPILE AS SYSTEM APP
        
        				echo
		echo
		echo
		echo "Compiles apk using original META_INF."
		
		
		echo
		echo "For more info, select 'help' from 'munky menu'"
		echo
		echo "press ENTER to continue"
		echo	
		read
        
		cd ~/android/munky-rench/mod-projects

		ls | cat -n

			echo
				
				echo
  

			echo "Which file? Enter number of selection or 'x' to exit"

				read choice


		
		
			
			if [ $choice = 'x' ]  ; then 
	
		
					echo "are you sure? Press ENTER to exit"
			
						read
			
							exit

			
				else	
	

						OUTPUTS=`ls | sed -n $choice'p' `	



							apktool b $OUTPUTS  ~/android/munky-rench/out/$OUTPUTS

	
							unzip ~/android/munky-rench/out/$OUTPUTS -d ~/android/munky-rench/staging/


					cp ~/android/munky-rench/place-here-for-modding/$OUTPUTS ~/android/munky-rench/keep

									
							unzip -o ~/android/munky-rench/keep/$OUTPUTS -d ~/android/munky-rench/keep/
			
				
				 cp ~/android/munky-rench/keep/$OUTPUTS/META-INF ~/android/munky-rench/staging/
				 
				 	zip -r -0 ~/android/munky-rench/staging{.zip,}
				 	
				 		mv ~/android/munky-rench/staging.zip ~/android/munky-rench/out/system_$OUTPUTS
			

											
								


				echo
				echo
				echo
				echo "--------------------------------------------------------------"
				echo						 			
				echo "Compiled SYSTEM apk in 'out' directory."
				echo "ENTER to return to munky menu"

				read

		
		fi
	
				cd ~/android/munky-rench

				
					./munky-rench ;;
  

	99)

exit 0
		exit#  ;;



esac

read 



exit 0
